<turbo-frame id="reservations_right">
  <div class="p-4 space-y-3">
    <% @active_reservations.sort_by { |r| r[:start_time] }.each do |reservation| %>
      <button
        data-turbo-frame="reservations_drawer"
        data-action="click->reservations#selectReservation dblclick->reservations#quickAction"
        data-reservation-id="<%= reservation[:id] %>"
        data-reservation-status="<%= reservation[:status] %>"
        tabindex="0"
        aria-selected="false"
        class="w-full p-4 bg-gray-800 hover:bg-gray-700 rounded-lg border-2 border-gray-700 hover:border-blue-500 transition-all text-left focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer aria-selected:border-blue-500 aria-selected:bg-gray-700"
        onclick="this.href = '<%= reservation_path(reservation[:id]) %>'; return true;"
      >
        <!-- Time and Status -->
        <div class="flex justify-between items-start mb-2">
          <div class="flex items-center gap-3">
            <span class="text-xl font-bold text-white">
              <%= reservation[:start_time].strftime("%H:%M") %>
            </span>
            <% if reservation[:status] == 'reserved' %>
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-800 text-yellow-200">
                RESERVED
              </span>
            <% else %>
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-800 text-green-200">
                SEATED
              </span>
            <% end %>
          </div>

          <!-- Timer -->
          <% if reservation[:status] == 'reserved' && reservation[:start_time] > Time.current %>
            <div class="text-right">
              <p class="text-xs text-gray-400">Starts in</p>
              <span
                data-controller="timer"
                data-timer-countdown-value="true"
                data-timer-start-at-value="<%= reservation[:start_time].iso8601 %>"
                class="text-sm font-mono text-yellow-400"
              >00:00:00</span>
            </div>
          <% elsif reservation[:status] == 'seated' %>
            <div class="text-right">
              <p class="text-xs text-gray-400">Elapsed</p>
              <span
                data-controller="timer"
                data-timer-start-at-value="<%= reservation[:start_time].iso8601 %>"
                class="text-sm font-mono text-green-400"
              >00:00:00</span>
            </div>
          <% end %>
        </div>

        <!-- Guest Info -->
        <div>
          <p class="font-medium text-white"><%= reservation[:guest_name] %></p>
          <p class="text-sm text-gray-400">
            Table <%= @tables&.find { |t| t[:id] == reservation[:table_id] }&.dig(:name) || reservation[:table_id] %>
            • <%= reservation[:duration] %> min
          </p>
          <% if reservation[:notes].present? %>
            <p class="text-sm text-gray-500 mt-1 italic"><%= reservation[:notes] %></p>
          <% end %>
        </div>
      </button>
    <% end %>

    <% if @active_reservations.empty? %>
      <div class="p-12 text-center">
        <div class="text-5xl text-gray-600 mb-4">◉</div>
        <p class="text-lg text-gray-400">No upcoming reservations</p>
        <p class="text-sm text-gray-500 mt-2">New bookings will appear here</p>
      </div>
    <% end %>
  </div>
</turbo-frame>