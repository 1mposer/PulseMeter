<turbo-frame id="main_panel">
  <%
    # Mock catalog data - replace with real data later
    catalog = {
      drinks: [
        { id: 1, name: "Coca Cola", price: 8.00 },
        { id: 2, name: "Sprite", price: 8.00 },
        { id: 3, name: "Water", price: 5.00 },
        { id: 4, name: "Red Bull", price: 15.00 },
        { id: 5, name: "Fresh Orange", price: 12.00 },
        { id: 6, name: "Coffee", price: 10.00 },
        { id: 7, name: "Tea", price: 8.00 },
        { id: 8, name: "Iced Coffee", price: 12.00 },
        { id: 9, name: "Lemonade", price: 10.00 }
      ],
      food: [
        { id: 10, name: "Burger", price: 35.00 },
        { id: 11, name: "Pizza Slice", price: 25.00 },
        { id: 12, name: "Sandwich", price: 20.00 },
        { id: 13, name: "Fries", price: 15.00 },
        { id: 14, name: "Wings", price: 30.00 },
        { id: 15, name: "Pasta", price: 40.00 }
      ],
      snacks: [
        { id: 16, name: "Chips", price: 8.00 },
        { id: 17, name: "Chocolate", price: 10.00 },
        { id: 18, name: "Cookies", price: 8.00 },
        { id: 19, name: "Nuts", price: 12.00 },
        { id: 20, name: "Popcorn", price: 15.00 }
      ],
      other: [
        { id: 21, name: "Tissue Box", price: 10.00 },
        { id: 22, name: "Lighter", price: 5.00 },
        { id: 23, name: "Gum", price: 5.00 }
      ]
    }

    entity_key = @entity_type && @entity_id ? "#{@entity_type}:#{@entity_id}" : "general"
  %>

  <div class="h-full flex" data-controller="goods-catalog cart" data-cart-entity-key-value="<%= entity_key %>">
    <!-- Left: Categories -->
    <div class="w-48 bg-gray-800 border-r border-gray-700 p-4">
      <div class="mb-4">
        <h2 class="text-lg font-semibold text-white mb-3">Categories</h2>
        <div class="space-y-2">
          <button
            data-goods-catalog-target="categoryBtn"
            data-category="drinks"
            data-action="click->goods-catalog#filterCategory"
            class="w-full py-3 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors text-left"
            aria-pressed="true"
          >
            Drinks
          </button>
          <button
            data-goods-catalog-target="categoryBtn"
            data-category="food"
            data-action="click->goods-catalog#filterCategory"
            class="w-full py-3 px-4 bg-gray-700 text-white rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors text-left"
            aria-pressed="false"
          >
            Food
          </button>
          <button
            data-goods-catalog-target="categoryBtn"
            data-category="snacks"
            data-action="click->goods-catalog#filterCategory"
            class="w-full py-3 px-4 bg-gray-700 text-white rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors text-left"
            aria-pressed="false"
          >
            Snacks
          </button>
          <button
            data-goods-catalog-target="categoryBtn"
            data-category="other"
            data-action="click->goods-catalog#filterCategory"
            class="w-full py-3 px-4 bg-gray-700 text-white rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors text-left"
            aria-pressed="false"
          >
            Other
          </button>
        </div>
      </div>

      <!-- Admin button (stub) -->
      <div class="mt-6 pt-6 border-t border-gray-700">
        <button
          onclick="event.preventDefault(); alert('Add Inventory - Coming soon')"
          class="w-full py-2 px-3 bg-gray-700 text-gray-300 text-sm rounded hover:bg-gray-600 transition-colors"
        >
          + Add Inventory
        </button>
      </div>
    </div>

    <!-- Center: Items Grid -->
    <div class="flex-1 p-6 overflow-y-auto">
      <div class="mb-4">
        <h1 class="text-2xl font-bold text-white">
          Goods Sale
          <% if @entity_name %>
            <span class="text-gray-400">| <%= @entity_name %></span>
          <% end %>
        </h1>
        <p class="text-sm text-gray-500 mt-1">Press 1-9 for quick add</p>
      </div>

      <div class="grid grid-cols-3 gap-3" data-goods-catalog-target="itemsGrid">
        <!-- Empty state (shown via JS when no items visible) -->
        <div class="col-span-full p-12 text-center hidden" data-goods-catalog-target="emptyState">
          <div class="text-6xl text-gray-600 mb-4">â—ˆ</div>
          <p class="text-xl text-gray-400">Choose a category to start</p>
        </div>
        <% catalog.each do |category, items| %>
          <% items.each_with_index do |item, index| %>
            <button
              data-goods-catalog-target="itemBtn"
              data-category="<%= category %>"
              data-item-id="<%= item[:id] %>"
              data-item-name="<%= item[:name] %>"
              data-item-price="<%= item[:price] %>"
              data-shortcut="<%= index + 1 if category == :drinks && index < 9 %>"
              data-action="click->goods-catalog#addItem"
              class="relative p-4 bg-gray-800 hover:bg-gray-700 rounded-lg border border-gray-700 hover:border-blue-500 transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 text-left <%= category != :drinks ? 'hidden' : '' %>"
            >
              <div class="font-medium text-white mb-1"><%= item[:name] %></div>
              <div class="text-sm text-gray-400">AED <%= sprintf("%.2f", item[:price]) %></div>
              <% if category == :drinks && index < 9 %>
                <div class="absolute top-2 right-2 w-6 h-6 bg-gray-700 rounded flex items-center justify-center text-xs text-gray-400">
                  <%= index + 1 %>
                </div>
              <% end %>
            </button>
          <% end %>
        <% end %>
      </div>
    </div>

    <!-- Right: Receipt Panel -->
    <div class="w-96 bg-gray-800 border-l border-gray-700 flex flex-col">
      <turbo-frame id="receipt_frame" class="flex-1 flex flex-col">
        <div class="p-4 border-b border-gray-700">
          <h2 class="text-lg font-semibold text-white">Receipt</h2>
        </div>

        <!-- Cart Items -->
        <div class="flex-1 overflow-y-auto p-4" data-cart-target="itemsList">
          <div class="text-center text-gray-500 py-8" data-cart-target="emptyMessage">
            Cart is empty
          </div>
        </div>

        <!-- Totals -->
        <div class="p-4 border-t border-gray-700 bg-gray-900">
          <div class="space-y-2 text-sm">
            <div class="flex justify-between text-gray-400">
              <span>Subtotal</span>
              <span data-cart-target="subtotal">AED 0.00</span>
            </div>
            <div class="flex justify-between text-gray-400">
              <span>VAT (5%)</span>
              <span data-cart-target="vat">AED 0.00</span>
            </div>
            <div class="flex justify-between text-xl font-bold text-white pt-2 border-t border-gray-700">
              <span>Total</span>
              <span data-cart-target="total">AED 0.00</span>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="p-4 space-y-2 border-t border-gray-700">
          <button
            data-action="click->cart#checkout"
            class="w-full py-3 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors"
          >
            Checkout (Enter)
          </button>
          <button
            data-action="click->cart#clearCart"
            class="w-full py-3 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors"
          >
            Clear Cart
          </button>
        </div>
      </turbo-frame>
    </div>
  </div>
</turbo-frame>